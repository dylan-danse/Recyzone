{% extends 'base.html.twig' %}

{% block body %}

<div class="col-md-offset-1 col-md-10">
<h1>Encodage déchets</h1>

    <br>
    <br>
    <br>

<div class="row">
    <form class="form-inline text-center">
        <div class="form-group">
            <label for="name">Nom</label>
            <input type="text" class="form-control" id="name" placeholder="John Doe">
        </div>
        <button type="button" onclick="searchHouseholds()" class="btn btn-primary">Rechercher</button>
    </form>
</div>

    <br>
    <br>
    <br>

<div class="row">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th class="text-center">Nom</th>
                <th class="text-center">Adresse</th>
                <th class="text-center">Email</th>
            </tr>
        </thead>
        <tbody id="bodyUsersTable">

        </tbody>
    </table>
</div>

    <br>
    <hr>
    <br>

<div class="row">
    <form class="form-inline text-center">
        <div class="form-group">
            <label for="wasteType">Type de déchet : </label>
            <select class="form-control">
                <option selected>Encombrants</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <div class="form-group">
            <label for="exampleInputEmail2">Volume : </label>
            <input type="number" class="form-control" id="inputVolume" placeholder="0">
        </div>
        <button type="submit" class="btn btn-primary">Ajouter</button>
    </form>
</div>

    <br>
    <br>
    <br>

<div class="row">
    <table id="wasteTable" class="table table-striped table-hover">
        <thead>
            <tr>
                <th class="text-center">Type de déchet</th>
                <th class="text-center">Volume</th>
                <th class="text-center">Quota annuel utilisé</th>
                <th class="text-center">Selection</th>
            </tr>
        </thead>
        <tbody id="bodyUsersTable">
            <tr class="text-center">
                <td>Déchets verts</td>
                <td>0.5m3</td>
                <td>20%</td>
                <td><input type="checkbox"></td>
            </tr>
            <tr class="text-center">
                <td>Déchets verts</td>
                <td>0.5m3</td>
                <td>20%</td>
                <td><input type="checkbox"></td>
            </tr>
        </tbody>
    </table>

</div>

<div class="row col-md-offset-4 col-md-4">
    <button type="button" class="btn btn-primary btn-block">Supprimer</button>
    <button type="button" class="btn btn-danger btn-block">Confirmer</button>
</div>

</div>

    <!-- reject if hour is not ok

    -->

    <script>
        function searchHouseholds() {
            var param = document.getElementById('name').value
            $.ajax({
                url: "./refreshUsersList",
                method: "post",
                data: {id: param}
            }).done(function(msg){
                refreshUsersList(msg);
            });
        }

        function refreshUsersList(msg){
            var tbody = '';

            $.each(JSON.parse(msg['data']), function(i, item){
                console.log(JSON.stringify(item));
               tbody +=  "<tr class=\'text-center\'> " +
                            "<td>" + item.firstName + " " + item.lastName +" </td> \
                            <td>" + item.houseNumber + " " + item.streetName + " - " + "code" + " " + item.city + "</td> \
                            <td>" + item.email + "</td> \
                        </tr>";
            });

            if(tbody===''){
                tbody += '<tr class="text-center"><td colspan=\"3\">Aucun utilisateur correspondant au critère !</td></tr>';
            }

            $('#bodyUsersTable').html(tbody);
        }

        $(".wasteTable input[type=checkbox]").on("change", function() {
            $(this).closest("tr").toggleClass("info");
        }).filter(":checked").each(function() {
            $(this).closest("tr").addClass("info");
        });

        $('input[type=checkbox]').change(function () {
            $(this).closest('tr').find('td').toggleClass('info', this.checked);
        });


    </script>


{% endblock %}

